2022-06-19 14:42:52 - INFO: dict_items([('dataset', 'resume-zh'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 96), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 288), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 6), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'bert-base-chinese'), ('bert_learning_rate', 5e-06), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/resume-zh.json'), ('device', 2)])
2022-06-19 14:42:52 - INFO: Loading Data
2022-06-19 14:42:55 - INFO: 
+-----------+-----------+----------+
| resume-zh | sentences | entities |
+-----------+-----------+----------+
|   train   |    3819   |  13438   |
|    dev    |    463    |   1497   |
|    test   |    477    |   1630   |
+-----------+-----------+----------+
2022-06-19 14:43:08 - INFO: Building Model
2022-06-19 14:43:16 - INFO: Epoch: 0
2022-06-19 14:44:15 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.1555 | 0.2118 |   0.2255  | 0.2633 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:44:18 - INFO: EVAL Label F1 [0.99883287 0.97850087 0.99090909 0.94285714 0.96551724 0.63895602
 0.83673469 0.68731988 0.8125     0.        ]
2022-06-19 14:44:18 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7852 |   0.7740  | 0.8258 |
| Entity | 0.8931 |   0.9076  | 0.8791 |
+--------+--------+-----------+--------+
2022-06-19 14:44:21 - INFO: TEST Label F1 [0.9989116  0.97778594 0.99115044 0.94915254 1.         0.64217805
 0.83417085 0.68305648 0.71875    0.        ]
2022-06-19 14:44:21 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7795 |   0.7594  | 0.8293 |
| Entity | 0.9089 |   0.9311  | 0.8877 |
+--------+--------+-----------+--------+
2022-06-19 14:44:21 - INFO: Epoch: 1
2022-06-19 14:45:21 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0042 | 0.8187 |   0.8842  | 0.7764 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:45:23 - INFO: EVAL Label F1 [0.99972342 0.98891448 0.99099099 0.98507463 0.96551724 0.93513899
 0.94835681 0.90441176 0.91891892 1.        ]
2022-06-19 14:45:23 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9637 |   0.9571  | 0.9711 |
| Entity | 0.9460 |   0.9501  | 0.9419 |
+--------+--------+-----------+--------+
2022-06-19 14:45:26 - INFO: TEST Label F1 [0.99975491 0.98663589 0.99115044 0.98245614 1.         0.95189224
 0.96428571 0.93273543 0.90140845 1.        ]
2022-06-19 14:45:26 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9710 |   0.9615  | 0.9816 |
| Entity | 0.9591 |   0.9681  | 0.9503 |
+--------+--------+-----------+--------+
2022-06-19 14:45:29 - INFO: Epoch: 2
2022-06-19 14:46:29 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0024 | 0.9099 |   0.9337  | 0.8898 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:46:32 - INFO: EVAL Label F1 [0.99975116 0.98742184 0.99547511 1.         0.93333333 0.94436519
 0.95412844 0.94028436 0.94736842 1.        ]
2022-06-19 14:46:32 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9702 |   0.9601  | 0.9811 |
| Entity | 0.9502 |   0.9451  | 0.9552 |
+--------+--------+-----------+--------+
2022-06-19 14:46:35 - INFO: TEST Label F1 [0.9997827  0.98727273 0.99555556 1.         1.         0.9593286
 0.97368421 0.94927536 0.89189189 1.        ]
2022-06-19 14:46:35 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9757 |   0.9651  | 0.9885 |
| Entity | 0.9600 |   0.9630  | 0.9571 |
+--------+--------+-----------+--------+
2022-06-19 14:46:37 - INFO: Epoch: 3
2022-06-19 14:47:37 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0017 | 0.9410 |   0.9561  | 0.9276 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:47:40 - INFO: EVAL Label F1 [0.9997365  0.98691268 0.99099099 1.         0.93333333 0.94571429
 0.95022624 0.93135436 0.94736842 1.        ]
2022-06-19 14:47:40 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9686 |   0.9546  | 0.9836 |
| Entity | 0.9526 |   0.9454  | 0.9599 |
+--------+--------+-----------+--------+
2022-06-19 14:47:43 - INFO: TEST Label F1 [0.99979405 0.98929001 0.99555556 0.96551724 1.         0.96067054
 0.94468085 0.94005213 0.91428571 1.        ]
2022-06-19 14:47:43 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9710 |   0.9538  | 0.9897 |
| Entity | 0.9621 |   0.9580  | 0.9663 |
+--------+--------+-----------+--------+
2022-06-19 14:47:45 - INFO: Epoch: 4
2022-06-19 14:48:46 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0015 | 0.9449 |   0.9528  | 0.9376 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:48:48 - INFO: EVAL Label F1 [0.99976734 0.98805755 0.99547511 1.         0.96774194 0.94960965
 0.98148148 0.94106642 0.94736842 1.        ]
2022-06-19 14:48:48 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9771 |   0.9631  | 0.9920 |
| Entity | 0.9526 |   0.9448  | 0.9606 |
+--------+--------+-----------+--------+
2022-06-19 14:48:51 - INFO: TEST Label F1 [0.99977891 0.98744313 0.99555556 1.         1.         0.95402299
 0.98230088 0.94380018 0.92957746 1.        ]
2022-06-19 14:48:51 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9792 |   0.9697  | 0.9898 |
| Entity | 0.9565 |   0.9553  | 0.9577 |
+--------+--------+-----------+--------+
2022-06-19 14:48:54 - INFO: Epoch: 5
2022-06-19 14:49:54 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0011 | 0.9600 |   0.9645  | 0.9556 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:49:56 - INFO: EVAL Label F1 [0.99979122 0.98985393 0.99547511 1.         0.96774194 0.9519774
 0.98148148 0.94339623 0.94736842 1.        ]
2022-06-19 14:49:56 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9777 |   0.9641  | 0.9923 |
| Entity | 0.9572 |   0.9500  | 0.9646 |
+--------+--------+-----------+--------+
2022-06-19 14:49:59 - INFO: TEST Label F1 [0.99979533 0.98874501 0.99555556 1.         1.         0.95304569
 0.99107143 0.94727435 0.92957746 0.90909091]
2022-06-19 14:49:59 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9714 |   0.9712  | 0.9742 |
| Entity | 0.9596 |   0.9578  | 0.9613 |
+--------+--------+-----------+--------+
2022-06-19 14:50:02 - INFO: Epoch: 6
2022-06-19 14:51:02 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0008 | 0.9630 |   0.9689  | 0.9574 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:51:05 - INFO: EVAL Label F1 [0.99977505 0.9883897  0.99099099 1.         0.96774194 0.95353824
 0.97222222 0.94139887 0.92307692 1.        ]
2022-06-19 14:51:05 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9737 |   0.9593  | 0.9896 |
| Entity | 0.9563 |   0.9541  | 0.9586 |
+--------+--------+-----------+--------+
2022-06-19 14:51:08 - INFO: TEST Label F1 [0.9997846  0.98746654 0.98678414 1.         1.         0.95948553
 0.98230088 0.95102404 0.84615385 1.        ]
2022-06-19 14:51:08 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9713 |   0.9565  | 0.9903 |
| Entity | 0.9594 |   0.9612  | 0.9577 |
+--------+--------+-----------+--------+
2022-06-19 14:51:08 - INFO: Epoch: 7
2022-06-19 14:52:09 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0007 | 0.9729 |   0.9765  | 0.9697 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:52:11 - INFO: EVAL Label F1 [0.99976427 0.98717394 0.99547511 1.         0.96774194 0.95533141
 0.97695853 0.94117647 0.92307692 1.        ]
2022-06-19 14:52:11 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9747 |   0.9613  | 0.9895 |
| Entity | 0.9566 |   0.9560  | 0.9572 |
+--------+--------+-----------+--------+
2022-06-19 14:52:14 - INFO: TEST Label F1 [0.99980924 0.98863705 0.98245614 1.         1.         0.96315449
 0.98666667 0.95605381 0.89189189 1.        ]
2022-06-19 14:52:14 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9769 |   0.9657  | 0.9902 |
| Entity | 0.9650 |   0.9656  | 0.9644 |
+--------+--------+-----------+--------+
2022-06-19 14:52:14 - INFO: Epoch: 8
2022-06-19 14:53:15 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0006 | 0.9757 |   0.9793  | 0.9723 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:53:18 - INFO: EVAL Label F1 [0.99977813 0.98841643 0.99547511 1.         0.96774194 0.95149786
 0.97222222 0.94716981 0.92307692 1.        ]
2022-06-19 14:53:18 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9745 |   0.9600  | 0.9906 |
| Entity | 0.9585 |   0.9537  | 0.9633 |
+--------+--------+-----------+--------+
2022-06-19 14:53:21 - INFO: TEST Label F1 [0.99979786 0.98814707 0.99115044 1.         1.         0.96196003
 0.99107143 0.94755556 0.89189189 1.        ]
2022-06-19 14:53:21 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9772 |   0.9657  | 0.9908 |
| Entity | 0.9601 |   0.9596  | 0.9607 |
+--------+--------+-----------+--------+
2022-06-19 14:53:23 - INFO: Epoch: 9
2022-06-19 14:54:24 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0005 | 0.9812 |   0.9813  | 0.9811 |
+---------+--------+--------+-----------+--------+
2022-06-19 14:54:26 - INFO: EVAL Label F1 [0.99978044 0.98827591 0.99547511 1.         0.96774194 0.95708155
 0.97222222 0.943074   0.94736842 1.        ]
2022-06-19 14:54:26 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9771 |   0.9651  | 0.9899 |
| Entity | 0.9581 |   0.9549  | 0.9613 |
+--------+--------+-----------+--------+
2022-06-19 14:54:29 - INFO: TEST Label F1 [0.99980291 0.98820969 0.99115044 1.         1.         0.96191091
 0.99107143 0.95280499 0.90410959 1.        ]
2022-06-19 14:54:29 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9789 |   0.9685  | 0.9910 |
| Entity | 0.9638 |   0.9632  | 0.9644 |
+--------+--------+-----------+--------+
2022-06-19 14:54:29 - INFO: Best DEV F1: 0.9585
2022-06-19 14:54:29 - INFO: Best TEST F1: 0.9601
2022-06-19 14:54:32 - INFO: TEST Label F1 [0.99979786 0.98814707 0.99115044 1.         1.         0.96196003
 0.99107143 0.94755556 0.89189189 1.        ]
2022-06-19 14:54:32 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.9772 |   0.9657  | 0.9908 |
|   Entity   | 0.9601 |   0.9596  | 0.9607 |
+------------+--------+-----------+--------+
