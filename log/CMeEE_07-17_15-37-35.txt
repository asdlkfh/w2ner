2022-07-17 15:37:35 - INFO: dict_items([('dataset', 'CMeEE'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 96), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 288), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 4), ('learning_rate', 0.0001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'bert-base-chinese'), ('bert_learning_rate', 0.0001), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/resume-zh.json'), ('device', 'cuda:2')])
2022-07-17 15:37:35 - INFO: Loading Data
2022-07-17 15:37:48 - INFO: 
+-------+-----------+----------+
| CMeEE | sentences | entities |
+-------+-----------+----------+
| train |   14881   |  60059   |
|  dev  |    2455   |   9820   |
|  test |    2500   |   9818   |
+-------+-----------+----------+
2022-07-17 15:39:07 - INFO: Building Model
2022-07-17 15:39:14 - INFO: Epoch: 0
2022-07-17 15:44:58 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.1053 | 0.1396 |   0.1922  | 0.1273 |
+---------+--------+--------+-----------+--------+
2022-07-17 15:45:21 - INFO: EVAL Label F1 [0.99861072 0.80594267 0.42576419 0.512003   0.01512287 0.
 0.46624204 0.48875256 0.         0.         0.        ]
2022-07-17 15:45:21 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.3375 |   0.3817  | 0.3524 |
| Entity | 0.4517 |   0.6860  | 0.3368 |
+--------+--------+-----------+--------+
2022-07-17 15:45:43 - INFO: TEST Label F1 [0.99854863 0.8137931  0.42562432 0.48408433 0.02487562 0.
 0.48038095 0.44396552 0.         0.         0.        ]
2022-07-17 15:45:43 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.3338 |   0.3761  | 0.3466 |
| Entity | 0.4338 |   0.6495  | 0.3256 |
+--------+--------+-----------+--------+
2022-07-17 15:45:45 - INFO: Epoch: 1
2022-07-17 15:51:34 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0095 | 0.4176 |   0.6685  | 0.3499 |
+---------+--------+--------+-----------+--------+
2022-07-17 15:51:56 - INFO: EVAL Label F1 [0.99876055 0.82081194 0.57321773 0.65068633 0.45098039 0.25889968
 0.54394359 0.69674185 0.57417582 0.40909091 0.51612903]
2022-07-17 15:51:56 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.5903 |   0.5615  | 0.6402 |
| Entity | 0.5727 |   0.5273  | 0.6268 |
+--------+--------+-----------+--------+
2022-07-17 15:52:18 - INFO: TEST Label F1 [0.99868605 0.82463942 0.54038179 0.62647444 0.43000701 0.37526652
 0.54881517 0.66955267 0.54102564 0.5        0.50847458]
2022-07-17 15:52:18 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.5967 |   0.5768  | 0.6378 |
| Entity | 0.5589 |   0.5157  | 0.6100 |
+--------+--------+-----------+--------+
2022-07-17 15:52:20 - INFO: Epoch: 2
2022-07-17 15:58:14 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0076 | 0.5777 |   0.6976  | 0.5146 |
+---------+--------+--------+-----------+--------+
2022-07-17 15:58:37 - INFO: EVAL Label F1 [0.99890194 0.81784178 0.59723593 0.66494134 0.4333713  0.28729282
 0.59885496 0.70728477 0.74285714 0.48275862 0.57142857]
2022-07-17 15:58:37 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6275 |   0.6497  | 0.6175 |
| Entity | 0.5888 |   0.6191  | 0.5613 |
+--------+--------+-----------+--------+
2022-07-17 15:59:00 - INFO: TEST Label F1 [0.99883142 0.81760431 0.56497742 0.63744428 0.43514896 0.4
 0.62834979 0.71356055 0.70957096 0.51012146 0.51724138]
2022-07-17 15:59:00 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6303 |   0.6420  | 0.6265 |
| Entity | 0.5825 |   0.6078  | 0.5593 |
+--------+--------+-----------+--------+
2022-07-17 15:59:02 - INFO: Epoch: 3
2022-07-17 16:04:53 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0066 | 0.6605 |   0.7391  | 0.6081 |
+---------+--------+--------+-----------+--------+
2022-07-17 16:05:16 - INFO: EVAL Label F1 [0.99890871 0.82870627 0.58126722 0.68905523 0.48061296 0.3001261
 0.61456204 0.73708381 0.75555556 0.33519553 0.52173913]
2022-07-17 16:05:16 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6221 |   0.6102  | 0.6436 |
| Entity | 0.6060 |   0.5928  | 0.6199 |
+--------+--------+-----------+--------+
2022-07-17 16:05:38 - INFO: TEST Label F1 [0.99883474 0.82949197 0.57104317 0.67785668 0.48353332 0.40564374
 0.6164324  0.72303595 0.71641791 0.5        0.50847458]
2022-07-17 16:05:38 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6392 |   0.6243  | 0.6617 |
| Entity | 0.5984 |   0.5834  | 0.6142 |
+--------+--------+-----------+--------+
2022-07-17 16:05:40 - INFO: Epoch: 4
2022-07-17 16:11:37 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0056 | 0.7078 |   0.7636  | 0.6668 |
+---------+--------+--------+-----------+--------+
2022-07-17 16:12:01 - INFO: EVAL Label F1 [0.99887062 0.82355363 0.5871163  0.69637574 0.45420614 0.30082645
 0.62259329 0.75073314 0.66964286 0.48241206 0.56      ]
2022-07-17 16:12:01 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6315 |   0.6139  | 0.6651 |
| Entity | 0.6103 |   0.5967  | 0.6245 |
+--------+--------+-----------+--------+
2022-07-17 16:12:25 - INFO: TEST Label F1 [0.99878374 0.82411499 0.54217926 0.70178218 0.46898263 0.41014333
 0.63315304 0.71994627 0.64130435 0.4627451  0.47887324]
2022-07-17 16:12:25 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6256 |   0.6068  | 0.6615 |
| Entity | 0.6073 |   0.5953  | 0.6198 |
+--------+--------+-----------+--------+
2022-07-17 16:12:27 - INFO: Epoch: 5
2022-07-17 16:18:30 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0045 | 0.7502 |   0.7915  | 0.7187 |
+---------+--------+--------+-----------+--------+
2022-07-17 16:18:55 - INFO: EVAL Label F1 [0.99889245 0.82263233 0.58193669 0.67490858 0.45145631 0.34647887
 0.63364702 0.78857143 0.75675676 0.48979592 0.53465347]
2022-07-17 16:18:55 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6436 |   0.6314  | 0.6626 |
| Entity | 0.6099 |   0.5957  | 0.6249 |
+--------+--------+-----------+--------+
2022-07-17 16:19:19 - INFO: TEST Label F1 [0.99883242 0.82640737 0.57290202 0.69996259 0.4749702  0.44204852
 0.63474903 0.7639485  0.71910112 0.55737705 0.53658537]
2022-07-17 16:19:19 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6570 |   0.6340  | 0.6918 |
| Entity | 0.6199 |   0.6038  | 0.6369 |
+--------+--------+-----------+--------+
2022-07-17 16:19:19 - INFO: Epoch: 6
2022-07-17 16:25:14 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0037 | 0.7888 |   0.8229  | 0.7612 |
+---------+--------+--------+-----------+--------+
2022-07-17 16:25:38 - INFO: EVAL Label F1 [0.99892173 0.81912729 0.58636948 0.69786444 0.45360825 0.32850242
 0.6348991  0.79213115 0.7530648  0.50246305 0.50526316]
2022-07-17 16:25:38 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6429 |   0.6313  | 0.6617 |
| Entity | 0.6085 |   0.6020  | 0.6151 |
+--------+--------+-----------+--------+
2022-07-17 16:26:02 - INFO: TEST Label F1 [0.99882573 0.81682149 0.56960409 0.71656687 0.48375036 0.42833608
 0.64280156 0.75018868 0.72900158 0.54545455 0.52459016]
2022-07-17 16:26:02 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6551 |   0.6429  | 0.6761 |
| Entity | 0.6176 |   0.6064  | 0.6292 |
+--------+--------+-----------+--------+
2022-07-17 16:26:02 - INFO: Epoch: 7
2022-07-17 16:32:01 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0029 | 0.8238 |   0.8468  | 0.8046 |
+---------+--------+--------+-----------+--------+
2022-07-17 16:32:25 - INFO: EVAL Label F1 [0.99893809 0.82628445 0.59489051 0.70551123 0.47091553 0.35097493
 0.63854397 0.76459742 0.73178808 0.52336449 0.53191489]
2022-07-17 16:32:25 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6489 |   0.6307  | 0.6728 |
| Entity | 0.6204 |   0.6095  | 0.6318 |
+--------+--------+-----------+--------+
2022-07-17 16:32:48 - INFO: TEST Label F1 [0.99884782 0.82444687 0.57247706 0.70922271 0.49687075 0.44611059
 0.64231069 0.74084312 0.69085631 0.55252918 0.51428571]
2022-07-17 16:32:48 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6535 |   0.6277  | 0.6868 |
| Entity | 0.6210 |   0.6060  | 0.6368 |
+--------+--------+-----------+--------+
2022-07-17 16:32:49 - INFO: Epoch: 8
2022-07-17 16:38:40 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0022 | 0.8575 |   0.8757  | 0.8415 |
+---------+--------+--------+-----------+--------+
2022-07-17 16:39:03 - INFO: EVAL Label F1 [0.99890428 0.82346155 0.58598172 0.70225873 0.47791353 0.3480589
 0.63627451 0.78045764 0.75086505 0.51674641 0.5       ]
2022-07-17 16:39:03 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6474 |   0.6190  | 0.6812 |
| Entity | 0.6182 |   0.5903  | 0.6489 |
+--------+--------+-----------+--------+
2022-07-17 16:39:26 - INFO: TEST Label F1 [0.99884514 0.82836749 0.57479285 0.69263716 0.49205949 0.45173042
 0.64172749 0.74767691 0.70889894 0.51937984 0.47222222]
2022-07-17 16:39:26 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6480 |   0.6166  | 0.6864 |
| Entity | 0.6170 |   0.5885  | 0.6484 |
+--------+--------+-----------+--------+
2022-07-17 16:39:26 - INFO: Epoch: 9
2022-07-17 16:45:10 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0017 | 0.8813 |   0.8930  | 0.8710 |
+---------+--------+--------+-----------+--------+
2022-07-17 16:45:33 - INFO: EVAL Label F1 [0.99892023 0.82352778 0.59645937 0.70451565 0.46841594 0.33425414
 0.63599415 0.78051866 0.74216028 0.52216749 0.47191011]
2022-07-17 16:45:33 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6435 |   0.6313  | 0.6617 |
| Entity | 0.6179 |   0.5974  | 0.6397 |
+--------+--------+-----------+--------+
2022-07-17 16:45:55 - INFO: TEST Label F1 [0.99885029 0.82559475 0.57982813 0.70292208 0.49225112 0.44875346
 0.64323427 0.75988287 0.71715611 0.53815261 0.55384615]
2022-07-17 16:45:55 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6600 |   0.6408  | 0.6844 |
| Entity | 0.6196 |   0.5976  | 0.6432 |
+--------+--------+-----------+--------+
2022-07-17 16:45:55 - INFO: Best DEV F1: 0.6204
2022-07-17 16:45:55 - INFO: Best TEST F1: 0.6210
2022-07-17 16:46:17 - INFO: TEST Label F1 [0.99884782 0.82444687 0.57247706 0.70922271 0.49687075 0.44611059
 0.64231069 0.74084312 0.69085631 0.55252918 0.51428571]
2022-07-17 16:46:17 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.6535 |   0.6277  | 0.6868 |
|   Entity   | 0.6210 |   0.6060  | 0.6368 |
+------------+--------+-----------+--------+
